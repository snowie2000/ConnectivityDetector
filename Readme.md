Inspired (and basically full code provided from https://stackoverflow.com/a/70438810/15358754)